<!--
title: Order Details
-->

<a id="back" href="javascript:history.back()">&#8592; Back</a>

{{ id | ifExists   | toInt | assignTo: id }}
{{ id | endIfEmpty | useFmt(
   `select o."Id", "OrderDate", "CustomerId", "Freight", 
           {0} as "Employee", e."Id" as "EmployeeId",
           s."CompanyName" as "ShipVia", 
           "ShipAddress", "ShipCity", "ShipPostalCode", "ShipCountry"
      from "Order" o
           inner join
           "Employee" e on o."EmployeeId" = e."Id"
           left join 
           "Shipper" s on o."ShipVia" = s."Id"
     where o."Id" = @id`,
     sqlConcat([`e."FirstName"`, `' '`, `e."LastName"`])) 
   | dbSingle({ id }) | assignTo: order }}

{{ id | endIfEmpty | useFmt(
   `select p."ProductName", 
           {0} UnitPrice,
           "Quantity", "Discount"
     from "OrderDetail" od
          inner join
          "Product" p on od."ProductId" = p."Id"
    where "OrderId" = @id`,
    sqlCurrency(`od."UnitPrice"`))
  | dbSelect({ id }) | assignTo: orderDetails }}

{{ { order, orderDetails } | ifExists(order) | selectPartial: order-details }}

{{ "There is no Order with id: {0}" | fmt(id) | ifNo(order) }}
